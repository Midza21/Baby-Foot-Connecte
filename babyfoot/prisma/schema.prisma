generator client {
  provider        = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// schema.prisma

model Game {
  id                  Int      @id @default(autoincrement())
  date                DateTime @default(now())
  adversaire1         Int      @map("adversaire1")
  adversaire2         Int      @map("adversaire2")
  score1              Int      @default(0)
  score2              Int      @default(0)
  etat                String   @default("En Cours")
  adversaire1Details  User     @relation("Adversaire1Details", fields: [adversaire1], references: [id])
  adversaire2Details  User     @relation("Adversaire2Details", fields: [adversaire2], references: [id])
  userGames           UserGame[]
}

model User {
  id       Int      @id @default(autoincrement())
  role  String  @db.VarChar(255) @default("user") // user ou admin
  password  String  @db.VarChar(255)  
  nom      String   
  buts  Int     @default(0)
  email String  @unique
  victoires Int     @default(0)
  games1   Game[]   @relation("Adversaire1Details")
  games2   Game[]   @relation("Adversaire2Details")
  userGames UserGame[]
}

model UserGame {
  id         Int    @id @default(autoincrement())
  userId     Int
  gameId     Int
  score      Int
  user       User   @relation(fields: [userId], references: [id])
  game       Game   @relation(fields: [gameId], references: [id])

  @@unique([userId, gameId])
}

